#!/usr/bin/env python

import unittest
from unpacme_al import UnpacMeAL
from unpacme import unpacme
import os
from assemblyline_v4_service.common.result import Result, ResultSection, BODY_FORMAT, Heuristic
from assemblyline_v4_service.common.request import ServiceRequest
from assemblyline.odm.messages.task import Task as ServiceTask
from assemblyline_v4_service.common.task import Task

API_RESPONSE = {'id': '3a12c859-4efe-43c8-aa21-898d0db2e64a', 'private': False, 'results': [{'analysis': {'exports': {}, 'imports': {'count': 5, 'entities': [{'functions': [{'import_by_ordinal': False, 'name': '?cout@std@@3V?$basic_ostream@DU?$char_traits@D@std@@@1@A'}, {'import_by_ordinal': False, 'name': '?_Tidy@?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@AAEX_N@Z'}, {'import_by_ordinal': False, 'name': '?assign@?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAEAAV12@PBDI@Z'}, {'import_by_ordinal': False, 'name': '??Hstd@@YA?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@0@ABV10@0@Z'}, {'import_by_ordinal': False, 'name': '??6std@@YAAAV?$basic_ostream@DU?$char_traits@D@std@@@0@AAV10@PBD@Z'}, {'import_by_ordinal': False, 'name': '??0Init@ios_base@std@@QAE@XZ'}, {'import_by_ordinal': False, 'name': '?endl@std@@YAAAV?$basic_ostream@DU?$char_traits@D@std@@@1@AAV21@@Z'}, {'import_by_ordinal': False, 'name': '??1_Winit@std@@QAE@XZ'}, {'import_by_ordinal': False, 'name': '??0_Winit@std@@QAE@XZ'}, {'import_by_ordinal': False, 'name': '??1Init@ios_base@std@@QAE@XZ'}], 'library': 'MSVCP60.dll'}, {'functions': [{'import_by_ordinal': False, 'name': 'LoadLibraryA'}, {'import_by_ordinal': False, 'name': 'GetModuleHandleA'}, {'import_by_ordinal': False, 'name': 'GetStartupInfoA'}, {'import_by_ordinal': False, 'name': 'GetProcAddress'}, {'import_by_ordinal': False, 'name': 'GetModuleHandleExA'}, {'import_by_ordinal': False, 'name': 'VirtualAlloc'}], 'library': 'KERNEL32.dll'}, {'functions': [{'import_by_ordinal': False, 'name': 'exit'}, {'import_by_ordinal': False, 'name': '_controlfp'}, {'import_by_ordinal': False, 'name': '_except_handler3'}, {'import_by_ordinal': False, 'name': '__set_app_type'}, {'import_by_ordinal': False, 'name': '__p__fmode'}, {'import_by_ordinal': False, 'name': '__p__commode'}, {'import_by_ordinal': False, 'name': 'malloc'}, {'import_by_ordinal': False, 'name': '??3@YAXPAX@Z'}, {'import_by_ordinal': False, 'name': '_adjust_fdiv'}, {'import_by_ordinal': False, 'name': '_onexit'}, {'import_by_ordinal': False, 'name': '_exit'}, {'import_by_ordinal': False, 'name': '_XcptFilter'}, {'import_by_ordinal': False, 'name': '__dllonexit'}, {'import_by_ordinal': False, 'name': '_acmdln'}, {'import_by_ordinal': False, 'name': '__getmainargs'}, {'import_by_ordinal': False, 'name': '_initterm'}, {'import_by_ordinal': False, 'name': '__setusermatherr'}], 'library': 'MSVCRT.dll'}, {'functions': [{'import_by_ordinal': False, 'name': 'GetStockObject'}], 'library': 'GDI32.dll'}, {'functions': [{'import_by_ordinal': False, 'name': 'SetDlgItemTextA'}, {'import_by_ordinal': False, 'name': 'DestroyWindow'}, {'import_by_ordinal': False, 'name': 'DispatchMessageA'}, {'import_by_ordinal': False, 'name': 'GetDlgItemTextA'}, {'import_by_ordinal': False, 'name': 'SetWindowTextA'}, {'import_by_ordinal': False, 'name': 'FindWindowA'}, {'import_by_ordinal': False, 'name': 'PostQuitMessage'}, {'import_by_ordinal': False, 'name': 'GetSystemMenu'}, {'import_by_ordinal': False, 'name': 'AppendMenuA'}, {'import_by_ordinal': False, 'name': 'DefWindowProcA'}, {'import_by_ordinal': False, 'name': 'LoadIconA'}, {'import_by_ordinal': False, 'name': 'LoadCursorA'}, {'import_by_ordinal': False, 'name': 'RegisterClassA'}, {'import_by_ordinal': False, 'name': 'CreateWindowExA'}, {'import_by_ordinal': False, 'name': 'ShowWindow'}, {'import_by_ordinal': False, 'name': 'UpdateWindow'}, {'import_by_ordinal': False, 'name': 'GetMessageA'}, {'import_by_ordinal': False, 'name': 'DialogBoxParamA'}, {'import_by_ordinal': False, 'name': 'TranslateMessage'}], 'library': 'USER32.dll'}]}, 'metadata': {'Characteristics': ['IMAGE_FILE_LOCAL_SYMS_STRIPPED', 'IMAGE_FILE_32BIT_MACHINE', 'IMAGE_FILE_EXECUTABLE_IMAGE', 'IMAGE_FILE_LINE_NUMS_STRIPPED'], 'Checksum': 0, 'Compile Time': 'Thu Oct 29 19:10:42 2020 UTC', 'Contains Compressed Data': False, 'EP Bytes': '55 54 5d 6a ff 68 00 40 40 00 68 a0 22 40 00 64 ', 'Entry Point': 8426, 'Image Base': 4194304, 'Linker Version': '6.0 - (Visual Studio 6)', 'PDB Path': None, 'Sections': 6, 'Signature': 17744, 'Size': 475136, 'Subsystem': 'IMAGE_SUBSYSTEM_WINDOWS_GUI', 'Type': 'PE32 executable (GUI) Intel 80386, for MS Windows', 'VersionInfo': {'StringInfo': {}, 'VarInfo': {}}}, 'resources': [{'entries': [{'entries': [{'codepage': 0, 'lang': 'LANG_ENGLISH', 'magic_type': 'data', 'offset': 29408, 'size': 744, 'sublang': 'ENGLISH_US'}], 'name': '0x1'}, {'entries': [{'codepage': 0, 'lang': 'LANG_ENGLISH', 'magic_type': 'GLS_BINARY_LSB_FIRST', 'offset': 30152, 'size': 296, 'sublang': 'ENGLISH_US'}], 'name': '0x2'}, {'entries': [{'codepage': 0, 'lang': 'LANG_ENGLISH', 'magic_type': 'data', 'offset': 30448, 'size': 3752, 'sublang': 'ENGLISH_US'}], 'name': '0x3'}], 'type': 'RT_ICON'}, {'entries': [{'entries': [{'codepage': 0, 'lang': 'LANG_ENGLISH', 'magic_type': 'data', 'offset': 395520, 'size': 362, 'sublang': 'ENGLISH_US'}], 'name': '0x66'}], 'type': 'RT_DIALOG'}, {'entries': [{'entries': [{'codepage': 0, 'lang': 'LANG_ENGLISH', 'magic_type': 'data', 'offset': 34248, 'size': 361267, 'sublang': 'ENGLISH_US'}], 'name': '0x1e55'}], 'type': 'RT_RCDATA'}, {'entries': [{'entries': [{'codepage': 0, 'lang': 'LANG_ENGLISH', 'magic_type': 'data', 'offset': 34200, 'size': 48, 'sublang': 'ENGLISH_US'}], 'name': '0x65'}], 'type': 'RT_GROUP_ICON'}], 'rich_headers': {'Checksum': '0xe34f0737', 'Entries': [{'Build': '6.0 (RTM, SP1 or SP2)', 'BuildId': 8168, 'Count': 11, 'ProdId': 10, 'Product': 'Utc12_C'}, {'Build': '6.13.7299', 'BuildId': 7299, 'Count': 1, 'ProdId': 14, 'Product': 'Masm613'}, {'Build': '6.0 (RTM, SP1 or SP2)', 'BuildId': 8168, 'Count': 4, 'ProdId': 4, 'Product': 'Linker600'}, {'Build': '<Unknown>', 'BuildId': 8034, 'Count': 4, 'ProdId': 19, 'Product': 'Linker512'}, {'Build': '<Unknown>', 'BuildId': 27412, 'Count': 3, 'ProdId': 257, 'Product': '<Unknown>'}, {'Build': '<Unknown>', 'BuildId': 0, 'Count': 53, 'ProdId': 1, 'Product': 'Import0'}, {'Build': '6.0 (RTM, SP1 or SP2)', 'BuildId': 8168, 'Count': 3, 'ProdId': 11, 'Product': 'Utc12_CPP'}, {'Build': '<Unknown>', 'BuildId': 1720, 'Count': 1, 'ProdId': 6, 'Product': 'Cvtres500'}]}, 'sections': [{'Characteristics': 1610612768, 'Entropy': 3.245678493555554, 'MD5': '8549e86b8f28815445927159cfba1cc2', 'Name': '.text', 'Name_Hex': '2e74657874', 'NumberOfLinenumbers': 0, 'NumberOfRelocations': 0, 'PointerToLinenumbers': 0, 'PointerToRawData': 4096, 'PointerToRelocations': 0, 'SHA1': '17a588826b2a36d0346ae892ce146e745bf56995', 'SHA256': '111100aa51a86ccc9dbf7210f9ef3c58cf5e142bfd63e094961fce1e9935032a', 'SizeOfRawData': 12288, 'VirtualAddress': 4096, 'VirtualSize': 9147}, {'Characteristics': 1073741888, 'Entropy': 0.02988508912012526, 'MD5': 'd7bfa72795a429a22c2933327a48ac36', 'Name': '.rdata', 'Name_Hex': '2e7264617461', 'NumberOfLinenumbers': 0, 'NumberOfRelocations': 0, 'PointerToLinenumbers': 0, 'PointerToRawData': 16384, 'PointerToRelocations': 0, 'SHA1': '8131fe90fd150d94904aec5241e4184b930888c5', 'SHA256': '5d1f689751501e401132d56c055a551addbb0b9a9c7e04c00c7763b920d75b95', 'SizeOfRawData': 4096, 'VirtualAddress': 16384, 'VirtualSize': 270}, {'Characteristics': 3221225536, 'Entropy': 1.443098462963217, 'MD5': '8d928a692e955f234e120052d3178dc6', 'Name': '.data', 'Name_Hex': '2e64617461', 'NumberOfLinenumbers': 0, 'NumberOfRelocations': 0, 'PointerToLinenumbers': 0, 'PointerToRawData': 20480, 'PointerToRelocations': 0, 'SHA1': '42171ed7fd780320f8c5e6db1fb4a681eedbd4f4', 'SHA256': 'b15604d73318a34aca555b9d17e991274baf00bed2ddcd00a266479a973a6369', 'SizeOfRawData': 4096, 'VirtualAddress': 20480, 'VirtualSize': 2488}, {'Characteristics': 3221225536, 'Entropy': 2.9333315128376642, 'MD5': '39eba814fac73307fa69560b90aa11be', 'Name': '.idata', 'Name_Hex': '2e6964617461', 'NumberOfLinenumbers': 0, 'NumberOfRelocations': 0, 'PointerToLinenumbers': 0, 'PointerToRawData': 24576, 'PointerToRelocations': 0, 'SHA1': '7cae484655be12aa364e038b48f521242865e20e', 'SHA256': '70e8e8af1f3c8a0406a1dcd236dc507a9525f3d3df707a102f7a71d765ac3bbc', 'SizeOfRawData': 4096, 'VirtualAddress': 24576, 'VirtualSize': 2744}, {'Characteristics': 1073741888, 'Entropy': 7.220953664572248, 'MD5': 'a72d5c59eba373db63bb3214393ac47c', 'Name': '.rsrc', 'Name_Hex': '2e72737263', 'NumberOfLinenumbers': 0, 'NumberOfRelocations': 0, 'PointerToLinenumbers': 0, 'PointerToRawData': 28672, 'PointerToRelocations': 0, 'SHA1': '16ecf1b21b703cd0cf7db5fea8183d5e5091cffd', 'SHA256': 'b9f9caeff9d49857733b9e181595d3102ec20e28023ca48e3f8680d4a29c7089', 'SizeOfRawData': 442368, 'VirtualAddress': 28672, 'VirtualSize': 440768}, {'Characteristics': 1107296320, 'Entropy': 1.3225349087380842, 'MD5': '64728f4512f1cc63a2e64ef7f62e22ad', 'Name': '.reloc', 'Name_Hex': '2e72656c6f63', 'NumberOfLinenumbers': 0, 'NumberOfRelocations': 0, 'PointerToLinenumbers': 0, 'PointerToRawData': 471040, 'PointerToRelocations': 0, 'SHA1': '4935ace22ba217482bfbc68eef1a5b3cc2dd4309', 'SHA256': '591fd3ecc610ad296ec8a83b7964e303a5c1f9741e1ec64092e94d5feb5ce571', 'SizeOfRawData': 4096, 'VirtualAddress': 471040, 'VirtualSize': 1906}]}, 'deepmatch': [], 'detectit': [{'name': 'Microsoft Visual C++', 'options': '-', 'string': 'compiler: Microsoft Visual C++(6.0)[-]', 'type': 'compiler', 'version': '6.0'}, {'name': 'Microsoft Linker', 'options': 'EXE32', 'string': 'linker: Microsoft Linker(6.0*)[EXE32]', 'type': 'linker', 'version': '6.0*'}], 'hashes': {'md5': '7e19bef2476d42a448c789491246492c', 'sha1': 'cfa549b56c74242b8b06278cbb7cc4ddb76cd369', 'sha256': '11b2e4900959874f4a335514c58c2ded88a3268b099984745e4c36d5ae434ea3'}, 'malware_id': [], 'strings': {'ascii': ['4D3T_9q', 'Nj$QcFx', 'F=\\&}Y"Tg', '^Yzp$YG?', 'y_b#!^p', 'S74Xf>A', 'W2?C*+c', '-NU~%MflH?', '3w@f-Ikd', 'C:\\Windows\\Setup\\State\\State.ini', 'p<&r^F&L0', 'N-e,CW`g*', '$/t+{P;rVd', '=hrk#4a', 'j@u;;_l', '|f/s(G+', ';TJ4Q%S', 'uUK#]LAD', 'Ygxq7){AZm', '.T)p={y', 'UpdateWindow', 'f@W[Mdh>', 'bt$?EJd;', '|jaV5e{', 'jbE8m6)', "',%aFn/", '[[RkHpF', '2$2.2R2', '333R3p3y3', 'GetDlgItemTextA', '!k%v{zpl', 't["^IKk', '`G!B/ kl', '&ImY)jJ', '5Ek[qdy', '_controlfp', 'OZ:67~2', '1pFDF\t~', 'ROp{V\t1', 'h^kpo2C', 'Windows Media Player', '<^i3."%', 'r/`Y>5J', 'GetModuleHandleExA', 'fyk^a!A', '_#1>UiZW', "ji'fjdN", 'Mf35FItY?', '__dllonexit', 'DefWindowProcA', '>#>+>F>K>R>Y>^>v>{>', 'c.]~V<d+', 'Y:|RL_3K ', 'XhxC9az8_', 'h9=dY;=$', '_onexit', '1k$fieAW', "-wjbc_'#/", 'Uo#sQ*XkX', '#yGdYs!b^6', '3)"X/\t(15', 'LdrFindResource_U', 'oGVJCWo{-?U', '"Vqy4fM', '&Show Window', "?~L@'#g", 'H!?sc[4', '=zkdXYu}', '??1_Winit@std@@QAE@XZ', 'KNIMnqN', 'k}ldq:P', 'v/1U^jD.', '<4H<2HM', 'P;$\\0At', 's$&^egz', 'y!(JRak"', 'NA$r""6_P', '\tQNw3;{g', "'0l_`7o[j", 'R8zsM/Rn', 'A_IThK%', ";z;';f(", '{.?g6C2', '<M.B~+C', '=1bkv$|', '$c)1!Sb?D', 'Dri1[L&', 'eMD})r#9U=t', 'x2%P/xs', 'Mo(Q0Ue.Od', 'bKvftW9', '+ (S3TH', 'w@Cvs{NZ', '_adjust_fdiv', ';_4|>8>', 'a%qmBYH', '7D7W7\\7l7v7', '>.:+4,_0', '.!xB$1^', 'uMukaNI', 'U6Nz1MPiK', "P'Yv.^Wo", "+bE'O@`S&", 'O- <3{m', '__p__fmode', 'rY}To 6>N', '05_rI7d', 'j}jNjHh', '&Hide Window', 'Mq<-=+74d7', 'Advapi32.dll', '&E{a4-N', 'o[Eq4RW', '_except_handler3', '#iE&h&{', '@@{kMgo', 'DispatchMessageA', "L?]r-'RQX", 'jXp{F=<\tLah', '>^x\t/Pu', '87f*W~0', 'u,3$$`M|[', 'fVh5Is^W', 'USER32.dll', 'V3*f7^Cl', 'Pw=zI~:', '$Cmb^Cn', '468SDF3', 'j7Azs,s', 'g}[.\tL6', '=HyxyqG', 'b[Gq#La$d', 'f3iTZ35', 'nq2\\9Hx', 'n!p:NVd', 'GetMessageA', '{Sd&pTo', 'utzMWWx', '.No{S|8', 'KP,pqAG', 'NYCYh;<', 'ShowWindow', 'cLZ,^g1', '6*:GpAH', '{`!U[:j!%N', '24&^{YD', '??0_Winit@std@@QAE@XZ', 'TranslateMessage', '<`;GQZa.8X', '\'1P^"Or#t', '9&959@9U9i9u9', 'i@eOeemS(<j0(V@iZ%ztS*%uQ129D&d*nk8XJxr6wQICnR#ZOG<5Q!(sn8n90%E53kH*$e(s>pYv+Je_nCW+1#', '__getmainargs', '>\tFE66{7', 'np J,@d3', 'ZDmK]gR', '\t2\tK]JP', 'f%?@(!Lo', 's%P[[gN[?=0"', 'L0BnXUk', 'nR\tV:mi', 'qhccude', 'gOxA~pCj', 'oKSsr<W', '@xa0@/IE', '/~5sEt<', 'BRo=p>K(b', '*Y;i,Hl,', 'U_W_%4xl', '>6AS)k(U?', 'kZvy7,_^', 'wt]ZH&T', 'Luz4:c*', '~HV-p 9/', '.f\t6ZeQ', '4S/ qeM', '01171Q1q1w1', 'WMPlayerApp', '7%3J+p1DSi', 'Windows Media Player HWND Editor', 't%kCkXU', 'S7{/-f6&]', 'S@B6X_+;I1', '4!4&40464;4E4K4P4Z4_4g4q4w4|4', 'GetSystemMenu', 'This program was created in using pure Win32 API (in C++). The purpose of this program is to save both screen memory and taskbar space by hiding the Windows Media Player Window.', 'J#eq _&;', '\\AGg\t~b', 'Yz?XI<S', 'ntdll.dll', '.C0%o\th(', '1iILtp{`', 'wU*^8+{', '7g;v=$=', 'DR3c1X4', '?endl@std@@YAAAV?$basic_ostream@DU?$char_traits@D@std@@@1@AAV21@@Z', 'G-xRY$}', '`.rdata', ',cFA:JO!', '7P)mJ{hz', "4)Di'q,", 'HF8yYCa', '-tB$kH/', '~[@{sU_', '*#+\ts9Lh', ';G(bVB0', '^iAoWyF', 'K1MI@j-', ')W?WsBi', 'qA&<IwmQ', 'H%YsVe4r', 'gF*v]`J', '__set_app_type', 'yUF\tF(5', '\\^$dq/@~', 'fk4>^(`auY', '/uObTlS', '@.reloc', 'PostQuitMessage', 'FaJr[#y', '-_5`OAG', ':}N\\&j@', 'Y4X{Xhc', '_XcptFilter', 'loQI}gS', "$,~%'_+", "U@#'pj*L", 'bZRh1zU', '??3@YAXPAX@Z', 'c|5yL\t4', 'L%Ep.sq7e', 'edrUk-=', '?U*}!i_', 'H0dpSY=B=', '}*%ZW~C', 'uQ2HP2h', "g!'6]vU", '??1Init@ios_base@std@@QAE@XZ', 'DestroyWindow', 'MSVCP60.dll', '7wE6nPP?', 'kernel32.dll', '0K1S`:g', 'sResource', '0$0*00060<0B0H0N0T0Z0`0f0l0r0x0~0', 'YY,jIZ-', '}xVpHYk{', 'WMPlayerWindowEditor', '_acmdln', 'HzBIMnXhj', 'CreateWindowExA', 'x(Ljr*@^', '"|i?~7j', 'zFy/]?p', 'GDI32.dll', 'c))/6Y=', 'oWis0gJ#', "GR,&'I-C[Q", '_initterm', 'LdrAccessResource', 'a)y_=b[kX', '^d/dao=', 'Jp{vduE,M', '7kz!\\w q', 'pH+C($iiw', 'jk6$m!#', '\t4>a`eh', ':v4"<q{', '!=w@K>5', ';d!Qh+6', '>.jnyD|', 'GetStartupInfoA', 'Q|+lF6%', '_O$.u}>', 'GetProcAddress', '?|53id7h', 'Yt<MQ~IY', '[YIdXH=#', 'SetWindowTextA', '?_Tidy@?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@AAEX_N@Z', "'4ip eq", 'GetStockObject', '9\\7\t^O$', '@*d/?bw', 'w3MT1d:M]s', '7)j)~js_Z!', '{QyhjTi', 'YaQkL"+', 'LoadCursorA', 'LoadIconA', ',WBHt9M', '7A+zl6P', 'LhzFN{F*', '%0aI&9s', 'bBw<.zp', 'w](vgM7', 'c.|/XZ_', 'Iar +"[', '-.0fXR?c', 'o*Fdyd5', 'FindWindowA', '$ ,5+Yn}', ']a\\=*;p', 'SetDlgItemTextA', '\\2m5EZo', '3M@tjYG', 'XeD3+>)', '^}PL\\=51', 'EncryptFileA', '{",Z<(2', '.Uh.nUO7N=', 'GetModuleHandleA', '*Fn=p\ty)', '7Mb\tbRh2+', ',y%4 .r', "'HVc`3)Iod", "8'8/858K8P8V8n8t8", 'aGN[F{5MC', 'D(v4Zq>', 'gmtMc?}', '9d!sjt6.', 'vu@,6dBG', "[A'n0V{*", '2$2D2J2P2V2\\2b2h2', '&Change Caption', 'DialogBoxParamA', "1 1'1.141<1B1I1P1[1b1h1s1x1", 'YK*S}_N', 'W1+n+*_k', 'i~U@jA(', 'MSVCRT.dll', 'nYs(~GG', 'vVTi&4V', '""5/C(F%dlfX', 'U_k*(!*cB7+A', '??0Init@ios_base@std@@QAE@XZ', '3\tK|FZp~', '??6std@@YAAAV?$basic_ostream@DU?$char_traits@D@std@@@0@AAV10@PBD@Z', '??Hstd@@YA?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@0@ABV10@0@Z', 'uWzGeiA', 'g<Lw@0{O', '|$>{Rll', 'KTeD|sE%-eq', 'RegisterClassA', 'jAg@qF#', '=9 a"%|;-', 'hD4R+$3', 'ryG@4Cj', 'uy:YD3!', 'About...', '?assign@?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAEAAV12@PBDI@Z', 'GCjZQ&*g', 'SVyJQ/;k', 'KERNEL32.dll', 'ReB]w 5', 'LoadLibraryA', '2?1;EFF', '1}N}$`;', 'he0r1n^v', '+5{F>R^p', '__setusermatherr', '\\y5*B[Q', 'E#RZI]]Ze', '__p__commode', '<}hg=ZdX', ')P(>861', 'ZXS}n6{', 'pW#"Iy2', 's?-#yCqP', 'Wj[<94-', '}\ts.Tsv!', '!This program cannot be run in DOS mode.', '=~E:?%4-', 'Q49HVcqu', 'UpUJ[k+', ':*:0:>:D:', '=5o1]lh', 'uZv?7]2', '#utDke%o[', 'tXL][6z', '#A$"5zj', '+Z5BJCY', '9~2/s-!', '{]l^=Yx', 'AppendMenuA', '%tPDyX9', 'S`;Zz@n', 'do@7ZO|', 'k3B!6=W', 'D,DjqTaA', 'q(@k8VSn8', 'OGH$7V0', '5_Zww\tr', "M.Sx}'1", '\t>dlPkE', '?cout@std@@3V?$basic_ostream@DU?$char_traits@D@std@@@1@A', 'VirtualAlloc'], 'stack': [], 'wide': ['webmaster@jaimemuscatelli.zzn.com', '2003 Jaime Muscatelli', 'MS Sans Serif']}, 'urls': []}, {'analysis': {'exports': {}, 'imports': {'count': 2, 'entities': [{'functions': [{'import_by_ordinal': False, 'name': 'qsort'}, {'import_by_ordinal': False, 'name': 'bsearch'}, {'import_by_ordinal': False, 'name': 'wcslen'}], 'library': 'ntdll.dll'}, {'functions': [{'import_by_ordinal': False, 'name': 'VirtualFree'}, {'import_by_ordinal': False, 'name': 'Process32Next'}, {'import_by_ordinal': False, 'name': 'Process32First'}, {'import_by_ordinal': False, 'name': 'CreateToolhelp32Snapshot'}, {'import_by_ordinal': False, 'name': 'CloseHandle'}, {'import_by_ordinal': False, 'name': 'SetLastError'}, {'import_by_ordinal': False, 'name': 'HeapAlloc'}, {'import_by_ordinal': False, 'name': 'HeapFree'}, {'import_by_ordinal': False, 'name': 'GetProcessHeap'}, {'import_by_ordinal': False, 'name': 'ExitProcess'}, {'import_by_ordinal': False, 'name': 'VirtualAlloc'}, {'import_by_ordinal': False, 'name': 'VirtualProtect'}, {'import_by_ordinal': False, 'name': 'VirtualQuery'}, {'import_by_ordinal': False, 'name': 'FreeLibrary'}, {'import_by_ordinal': False, 'name': 'GetProcAddress'}, {'import_by_ordinal': False, 'name': 'LoadLibraryA'}, {'import_by_ordinal': False, 'name': 'LoadLibraryW'}, {'import_by_ordinal': False, 'name': 'IsBadReadPtr'}], 'library': 'KERNEL32.dll'}]}, 'metadata': {'Characteristics': ['IMAGE_FILE_32BIT_MACHINE', 'IMAGE_FILE_EXECUTABLE_IMAGE', 'IMAGE_FILE_DLL'], 'Checksum': 0, 'Compile Time': 'Thu Oct 29 19:10:37 2020 UTC', 'Contains Compressed Data': False, 'EP Bytes': '55 8b ec 83 ec 0c 8b 45 0c 89 45 f8 c7 45 fc 00 ', 'Entry Point': 10160, 'Image Base': 268435456, 'Linker Version': '12.0 - (Visual Studio 2013)', 'PDB Path': None, 'Sections': 4, 'Signature': 17744, 'Size': 359936, 'Subsystem': 'IMAGE_SUBSYSTEM_WINDOWS_GUI', 'Type': 'PE32 executable (DLL) (GUI) Intel 80386, for MS Windows', 'VersionInfo': {'StringInfo': {}, 'VarInfo': {}}}, 'resources': [], 'rich_headers': {'Checksum': '0x91e62ca1', 'Entries': [{'Build': '<Unknown>', 'BuildId': 65501, 'Count': 2, 'ProdId': 203, 'Product': 'Implib1100'}, {'Build': '<Unknown>', 'BuildId': 0, 'Count': 21, 'ProdId': 1, 'Product': 'Import0'}, {'Build': '7.1 2003', 'BuildId': 4035, 'Count': 3, 'ProdId': 93, 'Product': 'Implib710'}, {'Build': '<Unknown>', 'BuildId': 40629, 'Count': 1, 'ProdId': 224, 'Product': '<Unknown>'}, {'Build': '<Unknown>', 'BuildId': 40629, 'Count': 1, 'ProdId': 222, 'Product': '<Unknown>'}]}, 'sections': [{'Characteristics': 1610612768, 'Entropy': 5.496491806176961, 'MD5': 'dc7a92e8ff652966e60cc407bca736da', 'Name': '.text', 'Name_Hex': '2e74657874', 'NumberOfLinenumbers': 0, 'NumberOfRelocations': 0, 'PointerToLinenumbers': 0, 'PointerToRawData': 1024, 'PointerToRelocations': 0, 'SHA1': '0cc281c84fdd1f0013186f1f99e1e7a71d371aa8', 'SHA256': 'a3a1f9667de08e2b417de9a8bcd314eaa982fb2c613c939154a4b6e8c8185c9a', 'SizeOfRawData': 6656, 'VirtualAddress': 4096, 'VirtualSize': 6156}, {'Characteristics': 1073741888, 'Entropy': 3.0994164692088186, 'MD5': 'fe639cbe7813d5783d83b3162e828a6f', 'Name': '.rdata', 'Name_Hex': '2e7264617461', 'NumberOfLinenumbers': 0, 'NumberOfRelocations': 0, 'PointerToLinenumbers': 0, 'PointerToRawData': 7680, 'PointerToRelocations': 0, 'SHA1': 'bc8933318525cf6dc1b62077444b44b1f8558c48', 'SHA256': '1f5b2af87b1cd498d3e67e77471e3204b31f4941ffaa02cef69cded028412a5f', 'SizeOfRawData': 1024, 'VirtualAddress': 12288, 'VirtualSize': 592}, {'Characteristics': 3221225536, 'Entropy': 5.547688404611802, 'MD5': '549073332e51c936aaae32f67c13e5b5', 'Name': '.data', 'Name_Hex': '2e64617461', 'NumberOfLinenumbers': 0, 'NumberOfRelocations': 0, 'PointerToLinenumbers': 0, 'PointerToRawData': 8704, 'PointerToRelocations': 0, 'SHA1': '45ffa693a096ac0d9ac519ee44d00c7c9828e85c', 'SHA256': 'caa129492f8aa166a8d44964541eb35b4adc7e6343877e7da9ea1c046e842df3', 'SizeOfRawData': 350720, 'VirtualAddress': 16384, 'VirtualSize': 350320}, {'Characteristics': 1107296320, 'Entropy': 2.0653089715536996, 'MD5': '8feeb5c33ee071e1b62d2a3119482c55', 'Name': '.reloc', 'Name_Hex': '2e72656c6f63', 'NumberOfLinenumbers': 0, 'NumberOfRelocations': 0, 'PointerToLinenumbers': 0, 'PointerToRawData': 359424, 'PointerToRelocations': 0, 'SHA1': '05c7c4b23d115d4762d912493881af35e5eeb2d3', 'SHA256': 'c94f0f91d58c836a0eb6a0ea088bf7234cd9af023d50fcfb01c6a5794ffcae59', 'SizeOfRawData': 512, 'VirtualAddress': 368640, 'VirtualSize': 136}]}, 'deepmatch': [], 'detectit': [{'name': 'Microsoft Visual C/C++', 'options': '-', 'string': 'compiler: Microsoft Visual C/C++(2013 SP5)[-]', 'type': 'compiler', 'version': '2013 SP5'}, {'name': 'Microsoft Linker', 'options': 'DRIVER32', 'string': 'linker: Microsoft Linker(12.0*)[DRIVER32]', 'type': 'linker', 'version': '12.0*'}], 'hashes': {'md5': '8bce4480bcc8d1fc15e7ff742e837e44', 'sha1': 'c1e72911f3a0ac12e5e73b4e9a7eafee3ab283f0', 'sha256': '0fe30b6d85c420dc889a6eff1c35c9b25f016e98e263f3b3882dcfa7b2e36409'}, 'malware_id': [{'confidence': 'low', 'name': 'win_emotet_a2', 'reference': 'https://malpedia.caad.fkie.fraunhofer.de/details/win.emotet', 'source': 'malpedia'}], 'strings': {'ascii': ['8A8c8m8', '^RSVYZf', '4666>>>>888A>A=)', '8;8D8c8n8', 'fvffffffffx', ':!;B;a;j;', ';%<+<M<', '3$3C3d3m3', 'f+M}`)T', '9)9;9Z9', '2lrrrlkZ', 'NqN555GGIdfi', '595B5a5', ';!<K<W<v<', 'eeHH;:?9  AoR', ':*:E:S:r:', 'wjieeM*/', '8OOPy{z{', '<,<5<T<', '=5=<=[=z=', '=5>K>l>', '7*737R7', 'AABQvvv', ';5<T<_<~<', '2*2=2\\2', '0,1K1V1~1', 'tpppxxxz', '+oN/BJCChbdd\t', 'je_HE=%)', 'vuurNNN', '\t&+01**HHHI$', '=%lO/t0=R*', ':1;=;\\;b;', '3JDDDMTq', 'SetLastError', '=T>s>|>', ':/:4:`:', '3!4S4r4|4', '122C2J2p2', 'QqL4588^', '2clk[Y%', 'nnnWWWWnnnnnnonoooooo,', 'ExitProcess', 'ntdll.dll', '8;;<jZYZ', '4477888Q8^GGGGHGB', '445=vuv', '3,3Q3s3', "3'3<3[3", "\tddbelJ%'{8", '939I9k9x9', ':+**1~}', '8,8J8i8o8', 'Y)(=DMTr', '9>9C9`9', 'nH]|hCd', 'zzzuuuuuoho', '=?&j4uv', '{{{yzzzQooo&aab', '0>0C0I0P0', 'ohnpnpxx', '>3>9>|?', '9(:3:W:]:z:', 'Q^IIIJJJdffwwy', 'Nt@=7EG', 'VirtualQuery', 'rrr%zzz', '202i2}2', 'Rsn^^^ddfffffwwyyz', 'sZKyjSStfOXhK', '<6<<<Y<{<', 'eHH;?9# ', '1+++Z::;', '5.545S5u5~5', 'CreateToolhelp32Snapshot', 'sNR44788Id', 'HeapFree', ',QQRq}}}', 'LoadLibraryW', '030Z0_0{0', '484R4^4}4', 'Error protecting memory page', 'FreeLibrary', 'KERNEL32.dll', '9L:n:s:', 'VirtualProtect', 'LoadLibraryA', '0(1H1g1', 'Process32Next', 'gghhipppzz', 'yiiie_+', '@22,9Zu', 'zzyjeeH::999r6', '}rnPPIj', '203O3X3w3', 'Process32First', '435Z5y5I7t7', 'vffvfgfx{', "xtttstw}'", 'zzzvvvvvu', ';-;K;m;r;', 'GetProcAddress', '@@@{9998', 'GetProcessHeap', '7\t8&8;8Z8', '=4=X=z=', 'L$ SQVh', '4#4)4I4k4t4', 'Wpggghgiipxzzyzz', '7$7,7P7r7', '8#8B8p8y8', '2=3\\3e3', 'p:fez#b^ee', '5,6I6v6', '2%2*2a2', "7'767H7{7", '556T6j6', '1\t222Q2', 'xxysgfg', '><?[?q?', 'f~~~~~v', '171Y1b1', '!This program cannot be run in DOS mode.', ': ;?;H;g;', 'D$ _^][', 'HeapAlloc', 'imimTSTqt', 'je_;E=#!', 'GetNativeSystemInfo', '< <?<k<', '181A1`1', '__;E?9#"', '6q8G8>G8JJIfiwy', '=!>C>w>', '2&2A2d2m2', '>8?W?o?', ';);/;C;b;', 'T$ +T$8', '==="jjj', '5$5-5L5', 'xwxjsst,eef', 'r\\\\XXpnC', '818J8}8', 'L$$)D$(', 'uuuJ~~~', ';#;U;t;', '?#?+?J?S?r?', '?/?8?W?', 'WnQ5558GIIffi', "2'2K2Q2s2", '666Z6y6', '`.rdata', '7#7B7T7s7', '161?1^1', 'wwwchhi', 'bsearch', '4n65788Iddx', '|=G #4_', '8#868U8b8', '6)626Q6', '5558===', 't^^dddht', 'OOOvwwwz', 'CloseHandle', 't"=b=q7', '4\t5>5o5', 'zjje_HB)', '9":A:R:q:', 'VirtualAlloc', '(030W0]0z0', 'Rg555>8JIdffiz', '72geeh.', 'VirtualFree', '9,9N9W9v9', 'WWQ4478^g', '6q44788Q', 'IsBadReadPtr', '=&=E=T=', '2<4H4g4', '6D6c6t6'], 'stack': [], 'wide': ['MSH_SECURITY1(', 'okernel32.dll']}, 'urls': []}, {'analysis': {'exports': {}, 'imports': {'count': 0, 'entities': []}, 'metadata': {'Characteristics': ['IMAGE_FILE_32BIT_MACHINE', 'IMAGE_FILE_EXECUTABLE_IMAGE'], 'Checksum': 367613, 'Compile Time': 'Wed Oct 21 21:08:29 2020 UTC', 'Contains Compressed Data': False, 'EP Bytes': 'e8 7b 08 00 00 a1 c4 e2 40 00 85 c0 75 1b b9 3f ', 'Entry Point': 23760, 'Image Base': 4194304, 'Linker Version': '12.0 - (Visual Studio 2013)', 'PDB Path': None, 'Sections': 5, 'Signature': 17744, 'Size': 350208, 'Subsystem': 'IMAGE_SUBSYSTEM_WINDOWS_GUI', 'Type': 'PE32 executable (GUI) Intel 80386, for MS Windows', 'VersionInfo': {'StringInfo': {}, 'VarInfo': {}}}, 'resources': [{'entries': [{'entries': [{'codepage': 0, 'lang': 'LANG_NEUTRAL', 'magic_type': 'data', 'offset': 66300, 'size': 1640, 'sublang': 'NEUTRAL'}], 'name': '0x1'}, {'entries': [{'codepage': 0, 'lang': 'LANG_NEUTRAL', 'magic_type': 'dBase IV DBT of @.DBF, block length 512, next free block index 40', 'offset': 67940, 'size': 744, 'sublang': 'NEUTRAL'}], 'name': '0x2'}, {'entries': [{'codepage': 0, 'lang': 'LANG_NEUTRAL', 'magic_type': 'data', 'offset': 68684, 'size': 488, 'sublang': 'NEUTRAL'}], 'name': '0x3'}, {'entries': [{'codepage': 0, 'lang': 'LANG_NEUTRAL', 'magic_type': 'GLS_BINARY_LSB_FIRST', 'offset': 69172, 'size': 296, 'sublang': 'NEUTRAL'}], 'name': '0x4'}, {'entries': [{'codepage': 0, 'lang': 'LANG_NEUTRAL', 'magic_type': 'data', 'offset': 69468, 'size': 3752, 'sublang': 'NEUTRAL'}], 'name': '0x5'}, {'entries': [{'codepage': 0, 'lang': 'LANG_NEUTRAL', 'magic_type': 'dBase IV DBT of @.DBF, block length 1024, next free block index 40', 'offset': 73220, 'size': 2216, 'sublang': 'NEUTRAL'}], 'name': '0x6'}, {'entries': [{'codepage': 0, 'lang': 'LANG_NEUTRAL', 'magic_type': 'data', 'offset': 75436, 'size': 1736, 'sublang': 'NEUTRAL'}], 'name': '0x7'}, {'entries': [{'codepage': 0, 'lang': 'LANG_NEUTRAL', 'magic_type': 'GLS_BINARY_LSB_FIRST', 'offset': 77172, 'size': 1384, 'sublang': 'NEUTRAL'}], 'name': '0x8'}, {'entries': [{'codepage': 0, 'lang': 'LANG_NEUTRAL', 'magic_type': 'dBase IV DBT, blocks size 0, block length 8192, next free block index 40', 'offset': 78556, 'size': 270376, 'sublang': 'NEUTRAL'}], 'name': '0x9'}, {'entries': [{'codepage': 0, 'lang': 'LANG_NEUTRAL', 'magic_type': 'data', 'offset': 348932, 'size': 9640, 'sublang': 'NEUTRAL'}], 'name': '0xa'}, {'entries': [{'codepage': 0, 'lang': 'LANG_NEUTRAL', 'magic_type': 'data', 'offset': 358572, 'size': 4264, 'sublang': 'NEUTRAL'}], 'name': '0xb'}, {'entries': [{'codepage': 0, 'lang': 'LANG_NEUTRAL', 'magic_type': 'data', 'offset': 362836, 'size': 2440, 'sublang': 'NEUTRAL'}], 'name': '0xc'}, {'entries': [{'codepage': 0, 'lang': 'LANG_NEUTRAL', 'magic_type': 'GLS_BINARY_LSB_FIRST', 'offset': 365276, 'size': 1128, 'sublang': 'NEUTRAL'}], 'name': '0xd'}], 'type': 'RT_ICON'}, {'entries': [{'entries': [{'codepage': 0, 'lang': 'LANG_NEUTRAL', 'magic_type': 'data', 'offset': 366404, 'size': 188, 'sublang': 'NEUTRAL'}], 'name': 'MSH_SECURITY1'}], 'type': 'RT_GROUP_ICON'}], 'rich_headers': {'Checksum': '0x8d95be2f', 'Entries': [{'Build': '<Unknown>', 'BuildId': 21005, 'Count': 1, 'ProdId': 223, 'Product': '<Unknown>'}, {'Build': '<Unknown>', 'BuildId': 31101, 'Count': 33, 'ProdId': 229, 'Product': '<Unknown>'}, {'Build': '<Unknown>', 'BuildId': 31101, 'Count': 1, 'ProdId': 222, 'Product': '<Unknown>'}]}, 'sections': [{'Characteristics': 1610612768, 'Entropy': 6.7914986952656085, 'MD5': '1c1738832c53f3a5684b7a6f32b06a20', 'Name': '.text', 'Name_Hex': '2e74657874', 'NumberOfLinenumbers': 0, 'NumberOfRelocations': 0, 'PointerToLinenumbers': 0, 'PointerToRawData': 1024, 'PointerToRelocations': 0, 'SHA1': 'c9bee4f93bc9247c1bd9e07b2c5b8de9852c2e20', 'SHA256': '997660a3614de90a90523e12a6e45cddf49955b18f57b95b1b8d089be5ddaced', 'SizeOfRawData': 42496, 'VirtualAddress': 4096, 'VirtualSize': 42116}, {'Characteristics': 1073741888, 'Entropy': 0.0, 'MD5': 'bf619eac0cdf3f68d496ea9344137e8b', 'Name': '.rdata', 'Name_Hex': '2e7264617461', 'NumberOfLinenumbers': 0, 'NumberOfRelocations': 0, 'PointerToLinenumbers': 0, 'PointerToRawData': 43520, 'PointerToRelocations': 0, 'SHA1': '5c3eb80066420002bc3dcc7ca4ab6efad7ed4ae5', 'SHA256': '076a27c79e5ace2a3d47f9dd2e83e4ff6ea8872b3c2218f66c92b89b55f36560', 'SizeOfRawData': 512, 'VirtualAddress': 49152, 'VirtualSize': 2}, {'Characteristics': 3221225536, 'Entropy': 7.202643933144552, 'MD5': 'd21921718ea0c124fb0075b61ca57a7c', 'Name': '.data', 'Name_Hex': '2e64617461', 'NumberOfLinenumbers': 0, 'NumberOfRelocations': 0, 'PointerToLinenumbers': 0, 'PointerToRawData': 44032, 'PointerToRelocations': 0, 'SHA1': '1cb3ecda374a1f2224fcd6c7ca223a385292999a', 'SHA256': '2d585eb876907df3b7b8e16ed819f53eab3e1158f0dddc04baf540bda9334aac', 'SizeOfRawData': 3072, 'VirtualAddress': 53248, 'VirtualSize': 6004}, {'Characteristics': 1107296320, 'Entropy': 6.4229536906760964, 'MD5': '5c72659ad98b719c9509c3db996e2ef4', 'Name': '.reloc', 'Name_Hex': '2e72656c6f63', 'NumberOfLinenumbers': 0, 'NumberOfRelocations': 0, 'PointerToLinenumbers': 0, 'PointerToRawData': 47104, 'PointerToRelocations': 0, 'SHA1': 'e11d05bd3785e35341e7f6e8fce7086b4c6f9a31', 'SHA256': 'c4106094486dec56ffc1f2b8e511026a7e22c0819778e7c76dd7e1e03dc42f1e', 'SizeOfRawData': 2048, 'VirtualAddress': 61440, 'VirtualSize': 1868}, {'Characteristics': 1073741888, 'Entropy': 5.213065156907439, 'MD5': 'd5a4e3d129b0e5ecc9d678fbbcccad19', 'Name': '.rsrc', 'Name_Hex': '2e72737263', 'NumberOfLinenumbers': 0, 'NumberOfRelocations': 0, 'PointerToLinenumbers': 0, 'PointerToRawData': 49152, 'PointerToRelocations': 0, 'SHA1': 'fde3fa4fd2e47c63d5187d87525d215f1c14aaef', 'SHA256': '06c9ebe4242d5109e271d93a3483daa12c043215f99b83d95de23f2cb4866e77', 'SizeOfRawData': 301056, 'VirtualAddress': 65536, 'VirtualSize': 301056}]}, 'deepmatch': [], 'detectit': [{'name': 'MASM', 'options': '-', 'string': 'compiler: MASM(-)[-]', 'type': 'compiler', 'version': '-'}, {'name': 'Microsoft Linker', 'options': 'EXE32', 'string': 'linker: Microsoft Linker(12.0*)[EXE32]', 'type': 'linker', 'version': '12.0*'}], 'hashes': {'md5': '7e36842240db73a01f01d5eac9ad5b36', 'sha1': 'cd4facba78f4b85187ce5d81da56c66b1c4fae2f', 'sha256': '8789a6a65a4b05c1795d1249c324fbb7093915543c9a4eccfa38577ece180f35'}, 'malware_id': [{'confidence': 'low', 'name': 'win_emotet_a2', 'reference': 'https://malpedia.caad.fkie.fraunhofer.de/details/win.emotet', 'source': 'malpedia'}], 'strings': {'ascii': ['8A8c8m8', '^RSVYZf', '4666>>>>888A>A=)', '8;8D8c8n8', 'fvffffffffx', ':!;B;a;j;', ';%<+<M<', '3$3C3d3m3', 'f+M}`)T', '9)9;9Z9', '2lrrrlkZ', 'NqN555GGIdfi', '595B5a5', 'eeHH;:?9  AoR', ':*:E:S:r:', 'wjieeM*/', '8OOPy{z{', '<,<5<T<', '=5=<=[=z=', '=5>K>l>', '7*737R7', 'AABQvvv', ';5<T<_<~<', '2*2=2\\2', '0,1K1V1~1', 'tpppxxxz', '+oN/BJCChbdd\t', 'je_HE=%)', 'vuurNNN', '\t&+01**HHHI$', '=%lO/t0=R*', ':1;=;\\;b;', '3JDDDMTq', '030Z0_0{0', '=T>s>|>', ':/:4:`:', '3!4S4r4|4', 'QqL4588^', 'nnnWWWWnnnnnnonoooooo,', 'je_;E=#!', '8;;<jZYZ', '4477888Q8^GGGGHGB', '445=vuv', '3,3Q3s3', "3'3<3[3", "\tddbelJ%'{8", '939I9k9x9', ':+**1~}', '8,8J8i8o8', 'Y)(=DMTr', '9>9C9`9', 'nH]|hCd', 'zzzuuuuuoho', '=?&j4uv', '{{{yzzzQooo&aab', 'ohnpnpxx', '>3>9>|?', '9(:3:W:]:z:', 'Q^IIIJJJdffwwy', 'Nt@=7EG', 'r\\\\XXpnC', 'rrr%zzz', '202i2}2', 'Rsn^^^ddfffffwwyyz', 'sZKyjSStfOXhK', '<6<<<Y<{<', 'eHH;?9# ', '1+++Z::;', '5.545S5u5~5', 'sNR44788Id', ',QQRq}}}', '484R4^4}4', '9L:n:s:', '2clk[Y%', '0(1H1g1', 'gghhipppzz', 'yiiie_+', '@22,9Zu', 'zzyjeeH::999r6', '}rnPPIj', '203O3X3w3', '435Z5y5I7t7', 'vffvfgfx{', "xtttstw}'", 'zzzvvvvvu', ';-;K;m;r;', '@@@{9998', '7\t8&8;8Z8', '=4=X=z=', 'L$ SQVh', '4#4)4I4k4t4', 'Wpggghgiipxzzyzz', '7$7,7P7r7', '8#8B8p8y8', '?/?8?W?', 'p:fez#b^ee', '2%2*2a2', "7'767H7{7", '556T6j6', '1\t222Q2', 'xxysgfg', '><?[?q?', 'f~~~~~v', '171Y1b1', '!This program cannot be run in DOS mode.', ': ;?;H;g;', 'D$ _^][', 'imimTSTqt', '< <?<k<', '181A1`1', '__;E?9#"', '6q8G8>G8JJIfiwy', '=!>C>w>', '72geeh.', '2&2A2d2m2', '>8?W?o?', ';);/;C;b;', 'T$ +T$8', '==="jjj', '5$5-5L5', 'xwxjsst,eef', 'L$$)D$(', ';#;U;t;', '?#?+?J?S?r?', ';!<K<W<v<', 'WnQ5558GIIffi', "2'2K2Q2s2", '666Z6y6', '`.rdata', '7#7B7T7s7', '161?1^1', 'wwwchhi', '4n65788Iddx', '|=G #4_', '8#868U8b8', '6)626Q6', '5558===', 't^^dddht', 'OOOvwwwz', 't"=b=q7', 'zjje_HB)', '9":A:R:q:', '(030W0]0z0', 'Rg555>8JIdffiz', '2=3\\3e3', 'uuuJ~~~', '9,9N9W9v9', 'WWQ4478^g', '6q44788Q', '=&=E=T=', '2<4H4g4', '6D6c6t6'], 'stack': [], 'wide': ['MSH_SECURITY1(']}, 'urls': []}], 'sha256': '11b2e4900959874f4a335514c58c2ded88a3268b099984745e4c36d5ae434ea3', 'status': 'complete', 'time': 1609022214.714571}
API_KEY = os.environ['UPM_API_KEY']

# Stolen from https://github.com/CybercentreCanada/assemblyline-service-characterize/blob/c5295ca900ff319c5e80b10382cdd7652c61eb2b/test/test_service.py#L16
sample1 = dict(
    sid=1,
    metadata={},
    service_name='characterize',
    service_config={},
    fileinfo=dict(
        magic='ASCII text, with no line terminators',
        md5='1f09ecbd362fa0dfff88d4788e6f5df0',
        mime='text/plain',
        sha1='a649bf201cde05724e48f2d397a615b201be34fb',
        sha256='dadc624d4454e10293dbd1b701b9ee9f99ef83b4cd07b695111d37eb95abcff8',
        size=19,
        type='unknown',
    ),
    filename='dadc624d4454e10293dbd1b701b9ee9f99ef83b4cd07b695111d37eb95abcff8',
    min_classification='TLP:WHITE',
    max_files=501,  # TODO: get the actual value
    ttl=3600,
)

class TestResults(unittest.TestCase):
    presults = None
    upm = unpacme.unpacme(API_KEY)
    upmal = UnpacMeAL()

    def test_proc_results(self):
        #Make sure general processing is working.
        procr = self.upmal.process_results(API_RESPONSE, self.upm)
        self.assertTrue(procr['unpacked'])

        #Make sure resulting samples downloaded properly.
        for sample in procr['unpacked_samples']:
            self.assertTrue(os.path.exists(sample['data_path']))

    def test_gen_results(self):
        procr = self.upmal.process_results(API_RESPONSE, self.upm)
        result = Result()
        service_task = ServiceTask(sample1)
        task = Task(service_task)
        request = ServiceRequest(task)
        self.upmal.generate_results(procr, result, API_RESPONSE, request)
